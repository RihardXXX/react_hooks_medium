import React from "react";
import classNames from "classnames";

import useFetch from 'hooks/useFetch';

const AddToFavorites = ({ isFavorite, favoriteCount, slug }) => {

    const apiUrl = `/articles/${slug}/favorite`;
    const [{ response }, doFetch] = useFetch(apiUrl);

    const favoritesCountWithResponse =
        response
            ? response.data.article.favoritesCount
            : favoriteCount;

    const isFavoriteResponse =
        response
            ? response.data.article.favorited
            : isFavorite;

    const buttonClasses = classNames({
        btn: true,
        'btn-sm': true,
        'btn-success': isFavoriteResponse,
        'btn-outline-success': !isFavoriteResponse
    })

    const onLike = (e) => {
        e.preventDefault();
        console.log('like', slug);
        doFetch({
            method: isFavoriteResponse ? 'delete' : 'post',
        })
    };

    return (
        <button className={buttonClasses} onClick={onLike}>
            <i className="ion-heart"></i>
            <span>
                &nbsp;
                { favoritesCountWithResponse }
            </span>
        </button>
    )
}

export default AddToFavorites;
