import React, { useContext, useState, useEffect } from "react";
import { CurrentUserContext } from 'context/currentUserContext';
import useFetch from 'hooks/useFetch';
import BackendErrorsMessages from "components/backendErrorsMessages";

const Settings = () => {

    const apiUrl = '/user';

    const [currentUserState] = useContext(CurrentUserContext);
    const [{ response, isLoading, errors }, doFetch] = useFetch(apiUrl);
    const [image, setImage] = useState('');
    const [name, setName] = useState('');
    const [bio, setBio] = useState('');
    const [email, setEmail] = useState('');

    // console.log(currentUserState);

    const handleSubmit = () => {
        console.log('submit');
    }

    useEffect(() => {
        if(!currentUserState.currentUser) {
            return;
        }
        // console.log(currentUserState.currentUser);
        const { image, username, bio, email } = currentUserState.currentUser;
        setImage(image);
        setName(username);
        setBio(bio);
        setEmail(email);
    }, [currentUserState.currentUser])

    return(
        <div className="container">
            { errors && (<BackendErrorsMessages errors={errors}/>) }
            <h1>Profiles update</h1>
            <form onSubmit={handleSubmit}>
                <div className="mb-3">
                    <label htmlFor="url" className="form-label">
                        url image
                    </label>
                    <input
                        type="text"
                        className="form-control"
                        id="url"
                        placeholder="please url profile"
                        value={image}
                        onChange={e => setImage(e.target.value)}
                    />
                </div>
                <div className="mb-3">
                    <label htmlFor="name" className="form-label">
                        name
                    </label>
                    <input
                        type="text"
                        className="form-control"
                        id="name"
                        placeholder="please enter name"
                        value={name}
                        onChange={e => setName(e.target.value)}
                    />
                </div>
                <div className="mb-3">
                    <label htmlFor="bio" className="form-label">
                        bio
                    </label>
                    <textarea
                        className="form-control"
                        id="bio" rows="3"
                        placeholder="please enter biography"
                        value={bio}
                        onChange={e => setBio(e.target.value)}
                    >

                    </textarea>
                </div>
                <div className="mb-3">
                    <label htmlFor="email" className="form-label">
                        email
                    </label>
                    <input
                        type="email"
                        className="form-control"
                        id="email"
                        placeholder="please enter email"
                        value={email}
                        onChange={e => setEmail(e.target.value)}
                    />
                </div>
                <div className="mb-3">
                    <label htmlFor="password" className="form-label">
                        password
                    </label>
                    <input
                        type="password"
                        className="form-control"
                        id="password"
                        placeholder="please enter tags article"
                    />
                </div>
                <button type="submit" className="btn btn-success">
                    update profiles
                </button>
            </form>
            <hr/>
            <button type="submit" className="btn btn-danger">
                Exit
            </button>
        </div>
    )
}

export default Settings;
