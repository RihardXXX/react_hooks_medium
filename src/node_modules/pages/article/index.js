import React, {Fragment, useEffect} from 'react';
import useFetch from 'hooks/useFetch';
import Loader from 'components/Loader';
import ErrorMessage from  'components/ErrorMessage';
import './article.css'

const Article = ({match}) => {

    const slug = match.params.slug;
    const apiUrl = `/articles/${slug}`;
    const [{response, isLoading, errors} , doFetch] = useFetch(apiUrl);

    // console.log(slug);
    // console.log('response: ', response);

    useEffect(() => {
        doFetch();
    }, [doFetch]);

    return (
        <div className="container">
            { isLoading && !response && <Loader /> }
            { errors && <ErrorMessage /> }
            <div className="article-header">
                {
                    response && !isLoading && (
                        <Fragment>
                            <div className="article-username">
                               <span className="badge bg-secondary">name</span>
                                &nbsp;
                                {response.data.article.author.username}
                            </div>
                            <div className="article-bio">
                                <span className="badge bg-secondary">biography</span>
                                &nbsp;
                                : {response.data.article.author.bio}
                            </div>
                        </Fragment>
                    )
                }
            </div>
            <hr/>
            <div className="article-body">
                {
                    response && !isLoading && (
                        <Fragment>
                            <div className="article-username">
                                <span className="badge bg-secondary">title</span>
                                <br/>
                                {response.data.article.title}
                            </div>
                            <div className="article-bio">
                                <span className="badge bg-secondary">
                                    {response.data.article.createdAt}
                                </span>
                                &nbsp;
                                <span className="badge bg-secondary">body</span>
                                <br/>
                                {response.data.article.body}
                            </div>
                        </Fragment>
                    )
                }
            </div>
        </div>
    )
}

export default  Article;
